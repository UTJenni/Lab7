---
title: "PSY329 - Lab7"
author: "Jennifer Habicher"
date: "2024-10-17"
output: "github_document"
---
# Load packages and dataset
```{r}
library(haven)
library(bruceR)
library(dplyr)
library(ggstatsplot)
library(performance)
library(sjPlot)

ex <- read_sav("/Users/northlight/Documents/GitHub/Lab7/ex.sav")

lab7<-read.csv("/Users/northlight/Documents/GitHub/Lab7/lab7.csv")



```

# Correlation
```{r}
#First, you will need to select variables or composites of interest (because there is no participant ID, we don't need to do this in this case, but will for your own datasets; here, just change title of dataset, EX to Lab7)

ex <- ex %>%
  select(Conscientiousness, AverageHoursofSleep, GPA)

#The Corr function also gives you a correlation plot between all variables, but it doesn't look pretty enough and not very customizable

Corr(ex)

#If you hate the correlation plot design, you can use the following function (way prettier that corr plot!)
ggcorrmat(ex)

#If you want to visualize the correlation between two specifcic variables, you can use the following code
ggplot(ex, aes(x = Conscientiousness, y = GPA)) + geom_point() + geom_smooth() + theme_bruce()

#Note that the line will naturally follow the data points, but you can specify to plot the fittest line by adding method = lm to the geom_smooth() function
ggplot(ex, aes(x = Conscientiousness, y = GPA)) + geom_point() + geom_smooth(method = lm) + theme_bruce()




```

# Regression
```{r}
#step 1: build a model (lm = linear model; ~ = "predicted by")
model<-lm(GPA ~ Conscientiousness + AverageHoursofSleep, data = ex)


#step 2: check the assumptions (after you have built your model, not the other way around)
check_model(model)

#step 3: summarize results; add ,std = TRUE if you want to get standardized coefficients
model_summary(model)


# or using the tab_model functionl; add  ,show.std = TRUE if you want to get standardized coefficients (this table is prettier and more standard than the above version)
tab_model(model)

#step 4: plot the results; change type ="est" to type = "std" if you want to plot the standardized coefficients
plot_model(model,  type ="est",  show.values = TRUE, vline.color = "#1B191999", line.size = 1.5, dot.size = 2.5, colors = "blue") + theme_bruce()

```



# Q1: Use the Corr or the ggcorrmat function to plot the correlation between all variables. Which personality traits are correlated with satisfaction with life and which one is not? The personality traits that seem to be correlated with satisfaction are Extraversion, Agrteeableness, Conscientiousness, and Emotional Stability. Openness does not appear to be correlated. 
```{r}
#First, you will need to select variables or composites of interest (because there is no participant ID, we don't need to do this in this case, but will for your own datasets; here, just change title of dataset, EX to lab7)

#The Corr function also gives you a correlation plot between all variables, but it doesn't look pretty enough and not very customizable

Corr(lab7)

#If you hate the correlation plot design, you can use the following function (way prettier that corr plot!)
ggcorrmat(lab7)

#If you want to visualize the correlation between two specifcic variables, you can use the following code
ggplot(lab7, aes(x = Extraversion, y = SWL)) + geom_point() + geom_smooth() + theme_bruce()
ggplot(lab7, aes(x = Agreeableness, y = SWL)) + geom_point() + geom_smooth() + theme_bruce()
ggplot(lab7, aes(x = Conscientiousness, y = SWL)) + geom_point() + geom_smooth() + theme_bruce()
ggplot(lab7, aes(x = EmotionalStability, y = SWL)) + geom_point() + geom_smooth() + theme_bruce()
ggplot(lab7, aes(x = Openness, y = SWL)) + geom_point() + geom_smooth() + theme_bruce()

#Note that the line will naturally follow the data points, but you can specify to plot the fittest line by adding method = lm to the geom_smooth() function
ggplot(lab7, aes(x = Extraversion, y = SWL)) + geom_point() + geom_smooth(method = lm) + theme_bruce()
ggplot(lab7, aes(x = Agreeableness, y = SWL)) + geom_point() + geom_smooth(method = lm) + theme_bruce()
ggplot(lab7, aes(x = Conscientiousness, y = SWL)) + geom_point() + geom_smooth(method = lm) + theme_bruce()
ggplot(lab7, aes(x = EmotionalStability, y = SWL)) + geom_point() + geom_smooth(method = lm) + theme_bruce()
ggplot(lab7, aes(x = Openness, y = SWL)) + geom_point() + geom_smooth(method = lm) + theme_bruce()


```

# Q2: Run a multiple regression using the Big 5 personality traits to predict satisfaction with life and plot the results
```{r}
#for this lab assignment you would assume assumptions are met, but for your own analysis, you will need to examine assumptions carefully
model<-lm(SWL ~ Extraversion + Agreeableness + Conscientiousness + EmotionalStability + Openness, data = lab7)
model_summary(model)
plot_model(model,  type ="est",  show.values = TRUE, vline.color = "#1B191999", line.size = 1.5, dot.size = 2.5, colors = "darkred") + theme_bruce()
```

# Q3: Interpret the R2. Which personality trait(s) can explain unique variance in satisfaction with life when controlling for each other, and which ones cannot? If someone asks you for advice on how to improve life satisfaction, based on your results, which personality trait would you recommend them to change and why?  

#The personality trait(s) that can explain unique variance in satisfaction with life when controlling for each other include: Extraversion, Emotional Stability, Openness. The personality trait(s) that cannot explain include: Agreeableness and Conscientiousness. To improve life satisfaction, the personality trait(s) that would most benefit from change include: Extraversion. This may be because it is the strongest predictor of SWL. (R2 0.138; 13.8% of variance SWL is explained by Big5 Personality variance.)
